ALTER TABLE app_user
    ADD CONSTRAINT uc_app_user_email UNIQUE (email);

ALTER TABLE product
    ADD CONSTRAINT uc_product_name UNIQUE (name);

ALTER TABLE product
DROP
COLUMN category_id;

ALTER TABLE product
DROP
COLUMN id;

ALTER TABLE product
DROP
COLUMN price;

ALTER TABLE product
    ADD category_id BIGINT NOT NULL;

ALTER TABLE product
    ADD CONSTRAINT FK_PRODUCT_ON_CATEGORY FOREIGN KEY (category_id) REFERENCES category (id);

ALTER TABLE product
ALTER
COLUMN description TYPE VARCHAR(255) USING (description::VARCHAR(255));

ALTER TABLE product
    ADD id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY;

ALTER TABLE product
ALTER
COLUMN name TYPE VARCHAR(255) USING (name::VARCHAR(255));

ALTER TABLE role
ALTER
COLUMN name TYPE VARCHAR(255) USING (name::VARCHAR(255));

ALTER TABLE role
    ALTER COLUMN name DROP NOT NULL;

ALTER TABLE app_user
    ALTER COLUMN password DROP NOT NULL;

ALTER TABLE product
    ADD price BIGINT NOT NULL;

ALTER TABLE app_user
    ALTER COLUMN username DROP NOT NULL;